# Documentation Technique : Licence 2N

## 1. Licence 2N

[cite_start]Link'nX est capable d'interagir avec les équipements 2N[cite: 17]. [cite_start]En enregistrant au préalable un appareil 2N, il est possible d'envoyer et de recevoir des commandes telles que l'ouverture d'une porte ou le verrouillage d'un portail[cite: 17].

### 1.1 Ajouter une licence à la passerelle Link'nX

[cite_start]Diverses licences peuvent être ajoutées à votre projet pour enrichir les fonctionnalités de vos passerelles Link'nX[cite: 20].

1.  [cite_start]Rendez-vous sur Can'nX, puis cliquez sur le bouton "Ajouter une extension" dans les options du projet contenant la Link'nX[cite: 21].
2.  [cite_start]Saisissez la clé dans le champ et confirmez[cite: 22].

**Récupérer votre clé :**
[cite_start]Afin de récupérer votre clé après un achat, il faut se rendre sur le site `www.can-nx.shop`, sur votre compte[cite: 23]. [cite_start]Un bouton "Clé de série" vous permet d'afficher la liste des clés que vous avez achetées[cite: 24].

---

### 1.2 Configuration préalable de l'appareil 2N

[cite_start]Pour permettre à la Link'nX de communiquer avec l'appareil 2N, il est important de paramétrer correctement ce dernier[cite: 61]. [cite_start]Accédez à l'interface en entrant l'adresse IP de l'appareil 2N dans l'URL d'un navigateur, puis dirigez-vous vers la page **"Services"**[cite: 62, 63].

#### 1.2.1 Configuration du Service API HTTP

[cite_start]Link'nX et l'appareil 2N communiquent grâce au système d'API HTTP mis à disposition par 2N[cite: 65]. [cite_start]Les services suivants doivent être activés (case cochée)[cite: 66]:

* [cite_start]**API d'interrupteur (Switch API) :** Permet à la Link'nX d'envoyer des commandes vers l'appareil 2N afin de commander les interrupteurs[cite: 67].
* [cite_start]**API d'enregistrement (Logging API) :** Permet à la Link'nX de récupérer les événements qui se produisent sur l'appareil 2N (Entrée d'un code, appel, ouverture de porte, ...)[cite: 68].

> **Note sur l'authentification :** Chaque service peut choisir un protocole d'authentification (Aucun, Basic, Digest). [cite_start]Cette information sera utile pour la Link'nX, car elle ne pourra pas communiquer si le protocole est différent[cite: 69, 70].

#### 1.2.2 Configuration du Compte API HTTP

[cite_start]Un compte doit être paramétré, activé et doit avoir les privilèges utilisateurs utiles également activés[cite: 129].

**Privilèges recommandés :**
* [cite_start]Système [cite: 156]
* [cite_start]Téléphone/appels [cite: 157]
* [cite_start]Gestion de l'accès [cite: 158]
* [cite_start]Entrées et sorties [cite: 159]
* [cite_start]Interrupteurs [cite: 160]
* [cite_start]Audio [cite: 161]
* [cite_start]Caméra [cite: 162]
* [cite_start]Ecran [cite: 163]
* [cite_start]E-mail [cite: 165]
* [cite_start]UID (cartes et Wiegand) [cite: 166]
* [cite_start]Clavier [cite: 167]

---

### 1.3 Déclaration d'un appareil 2N

[cite_start]La déclaration d'un appareil 2N s'effectue dans la page dédiée à 2N, accessible via le menu de navigation (option "2N")[cite: 171, 172].

**Champs du formulaire :**

1.  [cite_start]**Nom :** Nom de l'appareil 2N[cite: 202].
2.  [cite_start]**Adresse IP :** Adresse IP de l'appareil 2N[cite: 203].
3.  [cite_start]**Nom d'utilisateur :** Nom d'utilisateur du compte HTTP API[cite: 204].
4.  [cite_start]**Mot de passe :** Mot de passe du compte HTTP API[cite: 205].
5.  **Auth. [cite_start]Switch API :** Méthode d'authentification pour le service "API d'interrupteur"[cite: 212].
6.  **Auth. [cite_start]Logging API :** Méthode d'authentification pour le service "API d'enregistrement"[cite: 214].
7.  [cite_start]**Importation de configuration :** Importation du fichier XML téléchargeable depuis l'interface 2N (`Système` -> `Maintenance` -> `Enregistrer config`)[cite: 216].
    * [cite_start]*Avantage :* Remplit automatiquement le Nom et l'IP, et propose l'auto-complétion pour les utilisateurs et les méthodes d'authentification[cite: 217, 218, 220].

[cite_start]Une fois enregistré, l'appareil apparaît dans la liste avec son statut[cite: 222].

---

### 1.4 Création d'une action 2N

[cite_start]Pour créer une action, naviguez vers la page "Action" et cliquez sur **"+ Ajouter"**[cite: 236].

1.  [cite_start]**Type d'action :** Sélectionner "2N"[cite: 237, 266].
2.  [cite_start]**Nom :** Nom de l'action 2N[cite: 267].
3.  [cite_start]**Appareil 2N :** Sélectionner l'appareil à contrôler[cite: 268].
4.  [cite_start]**Numéro d'élément :** Numéro d'interrupteur affecté par l'action[cite: 269].
5.  [cite_start]**Action :** Commande à effectuer (voir Annexes pour la liste détaillée)[cite: 270].
6.  [cite_start]**Valider :** Enregistrer l'action[cite: 271].

---

### 1.5 Création d'un déclencheur 2N

[cite_start]Pour créer un déclencheur, naviguez vers la page "Déclencheur" et cliquez sur **"+ Ajouter"**[cite: 274].

1.  [cite_start]**Type de déclencheur :** Sélectionner "2N"[cite: 275, 306].
2.  [cite_start]**Nom :** Nom du déclencheur[cite: 307].
3.  [cite_start]**Appareil 2N :** Appareil sur lequel récupérer les événements[cite: 308].
4.  [cite_start]**Évènement :** L'événement que la Link'nX doit surveiller (ex: Code entré)[cite: 313].
5.  **Paramètres (Conditions) :** Facultatifs. [cite_start]Agissent comme des conditions (ex: le code doit être "1234")[cite: 315, 317]. [cite_start]Si vide, le déclencheur s'active à chaque réception de l'événement[cite: 316].

---

## 2. Annexes

### 2.1 Liste des actions 2N

| Action | Description |
| :--- | :--- |
| **Ouvrir** | [cite_start]Active / ouvre l'interrupteur sélectionné[cite: 323]. |
| **Fermer** | [cite_start]Désactive / ferme l'interrupteur sélectionné[cite: 326]. |
| **Verrouiller** | Verrouille l'interrupteur. [cite_start]Il restera désactivé/fermé et ne réagira qu'à l'action "Déverrouiller"[cite: 329]. |
| **Déverrouiller** | [cite_start]Permet un fonctionnement normal après un verrouillage[cite: 332]. |
| **Maintenir la porte ouverte** | [cite_start]Place l'interrupteur dans un état 'maintenu' (activé/ouvert)[cite: 334]. [cite_start]**Attention :** Vérifiez que votre gâche électrique supporte cet état sur la durée pour éviter de l'endommager[cite: 338, 339]. |
| **Relâcher l'ouverture maintenue** | [cite_start]Libère l'interrupteur de son état 'maintenu'[cite: 344]. |

### 2.2 Liste des déclencheurs 2N

| Évènement | Description | Paramètres |
| :--- | :--- | :--- |
| **Changement d'état de l'appareil** | [cite_start]Signale les changements d'état (ex: redémarrage)[cite: 346, 347]. | *Aucun* |
| **Mouvement détecté** | [cite_start]Détection via caméra (si équipée et activée) [cite: 348-350]. | [cite_start]**État :** Début ou Fin de l'événement[cite: 351]. |
| **Bruit détecté** | [cite_start]Augmentation du niveau de bruit (si activé)[cite: 352, 353]. | [cite_start]**État :** Début ou Fin de l'événement[cite: 354]. |
| **Code saisi** | [cite_start]Saisie d'un code via clavier numérique[cite: 355]. | [cite_start]**Code saisi :** Valeur exacte.<br>**Validité :** Valide/Invalide.<br>**ID Utilisateur :** Sélection dans la liste [cite: 357-359]. |
| **Carte saisie** | [cite_start]Carte RFID tapée/posée[cite: 364]. | [cite_start]**Validité :** Valide/Invalide.<br>**ID Utilisateur :** Sélection dans la liste[cite: 366, 367]. |
| **Entrée logique / Sortie logique modifiée** | [cite_start]Changement d'état d'une E/S[cite: 370]. | [cite_start]**État logique :** Valide/Invalide.<br>**Nom du port E/S :** Chaîne de caractères (ex: `led secured`)[cite: 372, 373]. |
| **Changement d'état de l'interrupteur** | [cite_start]Interrupteur actif/inactif[cite: 374]. | [cite_start]**Numéro :** 1, 2, 3, 4....<br>**État :** Actif/Inactif[cite: 375, 376]. |
| **Changement d'état de l'appel** | [cite_start]Connexion, Appel, Connecté, Terminé[cite: 377]. | [cite_start]**Direction :** Entrant/Sortant.<br>**État :** Se connecte, Sonne, Connecté, ou Terminé[cite: 380, 381]. |
| **Interrupteur d'auto-protection activé** | [cite_start]Ouverture non autorisée du boîtier (Tamper)[cite: 383]. | [cite_start]**État :** Début ou Fin de l'événement[cite: 386]. |
| **Ouverture de porte non autorisée** | [cite_start]Nécessite un capteur d'ouverture connecté[cite: 387]. | [cite_start]**État :** Début ou Fin de l'événement[cite: 388]. |
| **Porte ouverte trop longtemps** | [cite_start]Nécessite un capteur d'ouverture connecté[cite: 389]. | [cite_start]**État :** Début ou Fin de l'événement[cite: 391]. |
| **Utilisateur authentifié** | [cite_start]Authentification et ouverture de porte réussies[cite: 392]. | [cite_start]**Nom utilisateur :** Chaîne exacte.<br>**ID Utilisateur :** Sélection liste[cite: 395, 398]. |
| **Carte maintenue (4s)** | [cite_start]Carte RFID maintenue plus de 4 secondes[cite: 401]. | [cite_start]**ID du lecteur :** Nom du lecteur (ex: ext2).<br>**Résultat :** Valide/Invalide[cite: 402]. |
| **Alarme silencieuse** | [cite_start]Activation d'une alarme silencieuse ou bouton panique [cite: 403-405]. | *Aucun* |
| **Bouton REX activé** | [cite_start]Activation du bouton poussoir de sortie[cite: 406]. | *Aucun* |
| **Accès restreint** | [cite_start]Rejet de l'utilisateur[cite: 407]. | *Aucun* |
| **Identification biométrique** | [cite_start]Doigt posé sur le lecteur[cite: 408]. | [cite_start]**Validité :** Valide/Invalide.<br>**ID Utilisateur :** Sélection liste[cite: 411, 412]. |
| **Clé mobile saisie** | [cite_start]Authentification Bluetooth[cite: 415]. | [cite_start]**Validité :** Valide/Invalide.<br>**ID Utilisateur :** Sélection liste[cite: 416, 417]. |
| **Code DTMF saisi** | [cite_start]Code tonalité durant un appel[cite: 420]. | [cite_start]**Validité :** Valide/Invalide[cite: 421]. |
| **Changement d'état de la porte** | [cite_start]Porte ouverte/fermée[cite: 422]. | [cite_start]**État :** Ouvert/Fermé[cite: 423]. |
| **Utilisateur rejeté** | [cite_start]Rejet de l'authentification[cite: 424]. | [cite_start]**Motif :** Accès bloqué, Heure invalide, Séquence invalide, etc..<br>**ID Utilisateur :** Sélection liste[cite: 426, 427]. |